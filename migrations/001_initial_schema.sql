CREATE TABLE IF NOT EXISTS categories (id UUID PRIMARY KEY, name VARCHAR(100) NOT NULL, slug VARCHAR(100) UNIQUE NOT NULL, description TEXT, parent_id UUID, image_url TEXT, created_at TIMESTAMPTZ DEFAULT NOW());
CREATE TABLE IF NOT EXISTS products (id UUID PRIMARY KEY, sku VARCHAR(100) UNIQUE NOT NULL, name VARCHAR(255) NOT NULL, description TEXT, price BIGINT NOT NULL, compare_at_price BIGINT, currency VARCHAR(3) DEFAULT 'NGN', category_id UUID REFERENCES categories(id), inventory_quantity INTEGER DEFAULT 0, status VARCHAR(50) DEFAULT 'active', images TEXT[] DEFAULT '{}', tags TEXT[] DEFAULT '{}', metadata JSONB DEFAULT '{}', created_at TIMESTAMPTZ DEFAULT NOW(), updated_at TIMESTAMPTZ DEFAULT NOW());
CREATE TABLE IF NOT EXISTS orders (id UUID PRIMARY KEY, order_number VARCHAR(50) UNIQUE NOT NULL, customer_id UUID, customer_email VARCHAR(255) NOT NULL, status VARCHAR(50) DEFAULT 'pending', subtotal BIGINT DEFAULT 0, tax BIGINT DEFAULT 0, shipping BIGINT DEFAULT 0, total BIGINT DEFAULT 0, currency VARCHAR(3) DEFAULT 'NGN', shipping_address JSONB DEFAULT '{}', billing_address JSONB DEFAULT '{}', payment_status VARCHAR(50) DEFAULT 'pending', fulfillment_status VARCHAR(50) DEFAULT 'unfulfilled', created_at TIMESTAMPTZ DEFAULT NOW(), updated_at TIMESTAMPTZ DEFAULT NOW());
CREATE TABLE IF NOT EXISTS order_items (id UUID PRIMARY KEY, order_id UUID NOT NULL REFERENCES orders(id), product_id UUID NOT NULL, sku VARCHAR(100) NOT NULL, name VARCHAR(255) NOT NULL, quantity INTEGER NOT NULL, unit_price BIGINT NOT NULL, total BIGINT NOT NULL);
CREATE TABLE IF NOT EXISTS cart_items (id UUID PRIMARY KEY, session_id VARCHAR(100) NOT NULL, product_id UUID NOT NULL, quantity INTEGER DEFAULT 1, created_at TIMESTAMPTZ DEFAULT NOW(), UNIQUE(session_id, product_id));
CREATE INDEX idx_products_category ON products(category_id);
CREATE INDEX idx_orders_customer ON orders(customer_email);
CREATE INDEX idx_cart_session ON cart_items(session_id);
